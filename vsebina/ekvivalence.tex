\section{Ekvivalence in obrnljive funkcije}
\begin{definicija}
  Naj bo \(\defun{f}{A}{B}\) funkcija. Tip
  \[\sect f := \sumtype{g}{B \to A}{f \circ g \sim id}\]
  imenujemo \emph{tip prerezov funkcije f}. Za funkcijo \(f\) pravimo, da
  \emph{ima prerez}, če obstaja element tipa \(\sect(f)\), imenovan \emph{prerez f}.
  Tip \[\ret(f) := \sumtype{g}{B \to A}{g \circ f \sim id}\] imenujemo
  \emph{tip retrakcij funkcije f}. Za funkcijo \(f\) pravimo, da \emph{ima retrakcijo}, če
  obstaja element tipa \(\ret(f)\), imenovan \emph{retrakcija f}.
\end{definicija}

\begin{definicija}
  Pravimo, da je funkcija \(f\) \emph{ekvivalenca}, če ima tako prerez kot retrakcijo,
  torej, da obstaja element tipa \[\isequiv(f) := \sect(f) \times \ret(f).\]
  Pravimo, da je tip \(A\) \emph{ekvivalenten} tipu \(B\), če obstaja ekvivalenca med
  njima, torej element tipa \(A \simeq B := \sumtype{f}{A \to B}{\isequiv(f)}\).
\end{definicija}

\begin{definicija}
  Naj bo \(\defun{f}{A}{B}\) funkcija. Tip
  \[\isinv(f) := \sumtype{g}{B \to A}{(f \circ g \sim id) \times (g \circ f \sim id)}\]
  imenujemo \emph{tip inverzov funkcije f}. Za funkcijo \(f\) pravimo, da je
  \emph{obrnljiva} oziroma, da \emph{ima inverz}, če obstaja element tipa
  \(\isinv(f)\), imenovan \emph{inverz f}.
\end{definicija}

V definiciji obrnljivosti smo zahtevali, da ima funkcija obojestranski inverz, v
definiciji ekvivalence pa smo zahtevali le, da ima ločen levi in desni inverz.
To bi nas lahko
napeljalo k prepričanju, da je pojem obrnljivosti močnejši od pojma ekvivalence, vendar
spodnja trditev pokaže da sta pravzaprav logično ekvivalentna. Pokazali bomo, da lahko
prerez (ali simetrično, retrakcijo) ekvivalence \(f\) vedno izboljšamo do inverza,
kar pokaže, da je \(f\) tudi obrnljiva.

\begin{trditev}
  Funkcija je ekvivalenca natanko tedaj, ko je obrnljiva.
\end{trditev}

\begin{dokaz}
  Denimo, da je funkcija \(f\) obrnljiva. Tedaj lahko njen inverz podamo tako kot njen
  prerez, kot njeno retrakcijo, kar pokaže, da je ekvivalenca.

  Obratno denimo, da je funkcija \(f\) ekvivalenca. Podan imamo njen prerez \(s\) s
  homotopijo \(\homotopy{H}{f \circ s}{id}\) in njeno retrakcijo \(r\) s homotopijo
  \(\homotopy{K}{r \circ f}{id}\), s katerimi lahko konstruiramo homotopijo tipa
  \(s \circ f \sim id\) po sledečem izračunu:
  \[s f \overset{K^{-1}sf}{\sim} r f s f \overset{rHf}{\sim} r f \overset{K}{\sim} id. \qedhere\]
\end{dokaz}

\begin{definicija}
  Naj bo \(\typejudgment{f}{\pitype{x}{A}{\left(B(x) \to C(x)\right)}}\) družina funkcij.
  Definiramo (TODO prevedi total) funkcijo
  \(\typejudgment{\tot(f)}{\sumtype{x}{A}{Bx}} \to \sumtype{x}{A}{Cx}\) s predpisom
  \(\tot(f)(x, y) = (x, f(x, y))\).
\end{definicija}

\begin{izrek}
  Naj bo \(\typejudgment{f}{\pitype{x}{A}{\left(B(x) \to C(x)\right)}}\) družina funkcij.
  Tedaj je \(\tot(f)\) ekvivalenca natanko tedaj, ko je \(f\) družina ekvivalenc, torej
  ko je \(f(x)\) ekvivalenca za vsak \(\typejudgment{x}{A}\).
\end{izrek}

Zgornji izrek je pomemben, saj nam omogoči, da konstrukcijo ekvivalence med sigma tipi
nad istim baznim tipom poenostavimo na konstrukcijo družine ekvivalenc, kar je pogosto
veliko lažje. Uporabljali ga bomo v obliki sledeče posledice:

\begin{posledica}
  \label{equiv-tot}
  Naj bo \(A\) tip, \(B\) in \(C\) družini tipov nad \(A\) in denimo, da velja
  \(B(x) \simeq C(x)\) za vsak \(\typejudgment{x}{A}\).
  Tedaj velja \(\sumtype{x}{A}{B(x)} \simeq \sumtype{x}{A}{C(x)}\).
\end{posledica}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../Najdovski-27191110-2023"
%%% End:
